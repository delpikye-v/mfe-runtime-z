!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).MFERuntimeZ={})}(this,function(t){"use strict";var e=function(){return e=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},e.apply(this,arguments)};function n(t,e,n,o){return new(n||(n=Promise))(function(r,i){function u(t){try{c(o.next(t))}catch(t){i(t)}}function a(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(u,a)}c((o=o.apply(t,e||[])).next())})}function o(t,e){var n,o,r,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},u=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return u.next=a(0),u.throw=a(1),u.return=a(2),"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;u&&(u=0,a[0]&&(i=0)),i;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(r=i.trys,(r=r.length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(t,i)}catch(t){a=[6,t],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}"function"==typeof SuppressedError&&SuppressedError;var r=new Set;function i(t,e){return void 0===e&&(e={}),n(this,void 0,void 0,function(){var n,i,a,c,s,l;return o(this,function(o){switch(o.label){case 0:if(n=e.timeout,i=void 0===n?15e3:n,a=e.retries,c=void 0===a?1:a,r.has(t))return[2];s=0,o.label=1;case 1:if(!(s<=c))return[3,6];o.label=2;case 2:return o.trys.push([2,4,,5]),[4,u(t,i)];case 3:return o.sent(),r.add(t),[2];case 4:if(l=o.sent(),s===c)throw l;return[3,5];case 5:return s++,[3,1];case 6:return[2]}})})}function u(t,e){return new Promise(function(n,o){var r=document.createElement("script");r.src=t,r.async=!0;var i=setTimeout(function(){u(),o(new Error("Timeout loading ".concat(t)))},e);function u(){clearTimeout(i),r.remove()}r.onload=function(){u(),n()},r.onerror=function(){u(),o(new Error("Failed to load ".concat(t)))},document.body.appendChild(r)})}var a=function(){function t(){this.map=new Map}return t.prototype.on=function(t,e){this.map.has(t)||this.map.set(t,new Set),this.map.get(t).add(e)},t.prototype.off=function(t,e){var n;null===(n=this.map.get(t))||void 0===n||n.delete(e)},t.prototype.emit=function(t,e){var n;null===(n=this.map.get(t))||void 0===n||n.forEach(function(t){return t(e)})},t}(),c="ROUTER:REQUEST_NAVIGATE",s="ROUTER:NAVIGATE";function l(t,e){t.on(c,function(n){var o=n.path;e(o),t.emit(s,{path:o})})}var f=function(){function t(t){var e;void 0===t&&(t={}),this.eventBus=new a,this.stores=null!==(e=t.stores)&&void 0!==e?e:{},this.navigate=t.navigate,this.onRemoteError=t.onRemoteError,this.navigate&&l(this.eventBus,this.navigate)}return t.prototype.load=function(t,e){var r,u;return n(this,void 0,void 0,function(){var n,a,c;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,i(t,{retries:1})];case 1:return o.sent(),[3,3];case 2:throw n=o.sent(),null===(r=this.onRemoteError)||void 0===r||r.call(this,n),n;case 3:if(!(null==(a=window[e])?void 0:a.mount))throw c=new Error('Remote "'.concat(e,'" not found')),null===(u=this.onRemoteError)||void 0===u||u.call(this,c),c;return[2,a]}})})},t.prototype.mount=function(t,e,n){var o,r={name:n,eventBus:this.eventBus,stores:this.stores,host:{navigate:this.navigate}};try{t.mount(e,r),console.log("[MFE] mounted ".concat(n))}catch(t){throw null===(o=this.onRemoteError)||void 0===o||o.call(this,t),t}},t.prototype.unmount=function(t,e,n){var o,r;try{null===(o=t.unmount)||void 0===o||o.call(t,e),n&&console.log("[MFE] unmounted ".concat(n))}catch(t){null===(r=this.onRemoteError)||void 0===r||r.call(this,t)}},t.prototype.getEventBus=function(){return this.eventBus},t.prototype.reloadRemote=function(t){var e;return n(this,void 0,void 0,function(){var n,r,i,u,a,c;return o(this,function(o){switch(o.label){case 0:n=t.name,r=t.url,i=t.global,u=t.el,a=window[i];try{null===(e=null==a?void 0:a.unmount)||void 0===e||e.call(a,u)}catch(t){}return delete window[i],[4,this.load("".concat(r,"?t=").concat(Date.now()),i)];case 1:return c=o.sent(),this.mount(c,u,n),[2]}})})},t}();t.EventBus=a,t.MFEHost=f,t.createSharedRouter=function(t){var e=t.eventBus,n=t.name;return{go:function(t){e.emit(c,{from:n,path:t})},onChange:function(t){return e.on(s,function(e){t(e.path)})}}},t.createSharedStore=function(t){var n=t,o=new Set;return{getState:function(){return n},setState:function(t){n=e(e({},n),t),o.forEach(function(t){return t(n)})},subscribe:function(t){return o.add(t),function(){return o.delete(t)}}}},t.enableRouterSync=l,t.loadScript=i,Object.defineProperty(t,"__esModule",{value:!0})});
